<!DOCTYPE html>
<html>
<head>
	<title>Arduino/Genuino 101 CurieIMU Web Bluetooth Orientation Visualiser</title>
	<style>
		body{
			font-family: Helvetica;
			text-align:center;
		}
		ol{
			width:400px;
			text-align:left;
			margin:0 auto;
		}
	</style>
</head>
<body>
	<h1>Arduino/Genuino 101 CurieIMU Web Bluetooth Orientation Visualiser</h1>
	<script>
		//BLE
		let service        	= 0xBEEF;
		let characteristic 	= 0xFEED;
		let byteLength		= 20;
		//IMU global vars for processing
		let rate   = 0;

		window.onload = () => {
			document.getElementById('connect').onclick = connectBLE;
		}
		function connectBLE(){
			//BLE setup. Connect and get service/characteristic notifications
			navigator.bluetooth.requestDevice({ filters: [{ services: [service] }] })
			.then(device => {
        console.log(device.name);
        return device.gatt.connect();
      })
			.then(server => {
        return server.getPrimaryService(service);
      })
			.then(service => {
        return service.getCharacteristic(characteristic);
      })
			.then(characteristic => {
        var reset = Uint8Array.of(1);
				return characteristic.readValue();
        return characteristic.writeValue(reset);
      })
			.then(value => {
					console.log('Value is ' + value.getUint8(0));
			})
			.catch(error => { console.log(error); });

		}
	</script>
</body>
</html>
